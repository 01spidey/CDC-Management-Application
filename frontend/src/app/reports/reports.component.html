<div class="main">

    <img (click) = "section=1" src="../../assets/back.png" *ngIf="section==2" class="back">

    <div class="top">
        <div class="title" *ngIf="section==1">
            <h1>Reports Dashboard</h1>
            <hr id="line" style="width: 420px;">
        </div>

        <div class="title" *ngIf="section==2">
            <h1>{{action==='add'?'Add Report' : 'Edit Report'}}</h1>
            <hr id="line" style="width: 270px;">
        </div>

        <div *ngIf="section==1 && role=='Officer'" class="add-drive" (click)="changeSection(2)">
            <span class="material-symbols-outlined">
                add_box
            </span>
            <p>Add Report</p>
        </div>
    </div>
    
    <div class="filter-box" *ngIf="section==1">
        <div class="container">
            <div class="filter-container">

                <div class="temp-container">
                    <p style="color:#35363a">Category</p>
                    <div class="status-filter">
                    
                        <a style="text-decoration: none;">
                            <div class="status" [ngClass]="{'active-chip-orange' : report_filter=='All', 'not-active-chip':report_filter!='All'}" (click)="changeFilter('report', 'All')">
                                <span class="material-symbols-outlined">
                                    done
                                </span>
                                <p>All Reports</p>
                            </div>
                        </a>
                        
                        <a style="text-decoration: none;">
                            <div class="status" [ngClass]="{'active-chip-orange' : report_filter=='My', 'not-active-chip':report_filter!='My'}" (click)="changeFilter('report', 'My')">
                                <span class="material-symbols-outlined">
                                    done
                                </span>
                                <p>My Reports</p>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="temp-container">
                    <p>Period</p>
                    <div class="status-filter">
                        
                        <a style="text-decoration: none;">
                            <div class="status" [ngClass]="{'active-chip-blue' : period_filter=='Today', 'not-active-chip':period_filter!='Today'}" (click)="changeFilter('period', 'Today')">
                                <span class="material-symbols-outlined">
                                    done
                                </span>
                                <p>Today</p>
                            </div>
                        </a>

                        <a style="text-decoration: none;">
                            <div class="status" [ngClass]="{'active-chip-blue' : period_filter=='Custom', 'not-active-chip':period_filter!='Custom'}" (click)="changeFilter('period', 'Custom')">
                                <span class="material-symbols-outlined">
                                    done
                                </span>
                                <p>Custom</p>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="temp-container" *ngIf="report_filter==='My'">
                    <p>Visibility</p>
                    <div class="status-filter">
                        <a style="text-decoration: none;">
                            <div class="status" [ngClass]="{'active-chip-dark' : visibility==='Public', 'not-active-chip':visibility!='Public'}" (click)="changeFilter('vis', 'Public')">
                                <span class="material-symbols-outlined">
                                    done
                                </span>
                                <p>Public</p>
                            </div>
                        </a>
                        
                        <a style="text-decoration: none;">
                            <div class="status" [ngClass]="{'active-chip-dark' : visibility==='Private', 'not-active-chip':visibility!=='Private'}" (click)="changeFilter('vis', 'Private')">
                                <span class="material-symbols-outlined">
                                    done
                                </span>
                                <p>Private</p>
                            </div>
                        </a>
                    </div>
                </div>
    
            </div>
 
            <a>
                <span matTooltip="Refresh" class="material-symbols-outlined" id="refresh">
                    refresh
                </span>
            </a>
            
        </div>
        
        <div class="date-filter" *ngIf="period_filter==='Custom'">
            
            <mat-form-field>
                <mat-label>Filter By Date Range</mat-label>
                
                <mat-date-range-input [rangePicker]="picker">
                  <input matStartDate placeholder="Start date" [(ngModel)]="startDate">
                  <input matEndDate placeholder="End date" [(ngModel)]="endDate">
                </mat-date-range-input>

                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-date-range-picker #picker></mat-date-range-picker>
            </mat-form-field>
            <button mat-raised-button (click)="applyFilter()">Apply</button>
        </div>
    </div>

    <div class="grid-container" *ngIf="section==1">
        <ag-grid-angular
            class="ag-theme-alpine"
            style="width: 80%; height:500px"
            [rowData]="row_data"
            [columnDefs]="col_defs">
        </ag-grid-angular>
    </div>


    <div class="add-report-box" *ngIf="section==2" [ngStyle]="visibility==='Private'? {'background-color' : '#35363a'} : {}">

        <mat-slide-toggle class="vis-toggle" color="accent"
        (click) = "visibility= visibility==='Public'?'Private' : 'Public'"
        [ngStyle]="visibility==='Private'? {'background-color' : 'white'} : {'background-color' : '#35363a'}">
        
            <div class="toggle-txt" [ngStyle]="visibility==='Private'? {'color' : '#35363a'} : {'color' : 'white'}">
                <span class="material-symbols-outlined" *ngIf="visibility==='Public'">
                    lock_open
                </span>
    
                <span class="material-symbols-outlined" *ngIf="visibility==='Private'">
                    lock
                </span>
    
                <p> {{visibility}} </p>
            </div>
            
        </mat-slide-toggle>

        <form [formGroup]="addReportForm" *ngIf="section==2" [ngStyle]="visibility==='Private'? {'color' : 'white'} : {}">

            <div class="section">
                <div class="input">
                    <p>Company</p>
                    <mat-form-field class="input">
                        <mat-label>e.g. AutoDesk</mat-label>
                        <input matInput formControlName = "company">
                    </mat-form-field>
                </div>

                <div class="input">
                    <p>Contact Mode</p>
                    <mat-form-field>
                        <mat-label>e.g. Mail</mat-label>
                        <input matInput formControlName = "mode">
                    </mat-form-field>
                </div>

            </div>
            
            <div class="section">
                <div class="input">
                    <p>Date</p>
                    <mat-form-field>
                        <mat-label>Choose a date</mat-label>
                        <input matInput [matDatepicker]="picker_1" formControlName = "date">
                        <mat-datepicker-toggle matIconSuffix [for]="picker_1"></mat-datepicker-toggle>
                        <mat-datepicker #picker_1></mat-datepicker>
                      </mat-form-field>
                </div> 

                <div class="input">
                    <div class="reminder-toggle">
                      <p>Reminder</p>
                      <mat-slide-toggle [(ngModel)]="reminder" [ngModelOptions]="{standalone: true}" name="reminderToggle"></mat-slide-toggle>
                    </div>
                    <mat-form-field>
                      <mat-label>Choose a date</mat-label>
                      <input matInput [matDatepicker]="picker_2" [disabled]='!reminder' 
                      [(ngModel)]="reminder_date" [ngModelOptions]="{standalone: true}">
                  
                      <mat-datepicker-toggle matIconSuffix [for]="picker_2"></mat-datepicker-toggle>
                      <mat-datepicker #picker_2></mat-datepicker>
                    </mat-form-field>
                </div>
                  
            </div>
        

            <div class="section">
                <div class="input">
                    <p>HR Name</p>
                    <mat-form-field>
                        <mat-label>e.g. Tom H</mat-label>
                        <input matInput formControlName = "hr_name">
                    </mat-form-field> 
                </div>
    
                <div class="input">
                    <p>HR Mail</p>
                    <mat-form-field>
                        <mat-label>e.g. TomH@amazon.com*</mat-label>
                        <input matInput formControlName = "hr_mail">
                    </mat-form-field> 
                </div>
            </div>
            
            <div class="input">
                <p>Message</p>
                <mat-form-field>
                    <mat-label>Write Your Message Here</mat-label>
                    <textarea matInput formControlName="message"></textarea>
                </mat-form-field> 
            </div>

            <div class="input" *ngIf="visibility==='Private'">
                <p>Visible To</p>
                <mat-form-field class="example-chip-list">
                    <mat-label>Add Members</mat-label>
                    <mat-chip-grid #chipGrid aria-label="Enter members">
                      <mat-chip-row *ngFor="let member of member_lst"
                                    (removed)="remove(member)"
                                    [editable]="true"
                                    (edited)="edit(member, $event)"
                                    [aria-description]="'press enter to edit ' + member">
                        {{member}}
                        <button matChipRemove [attr.aria-label]="'remove ' + member">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </mat-chip-row>
                      <input placeholder="New Member..."
                             [matChipInputFor]="chipGrid"
                             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                             [matChipInputAddOnBlur]="addOnBlur"
                             (matChipInputTokenEnd)="add($event)"/>
                    </mat-chip-grid>
                  </mat-form-field>
            </div>
                         

            <div class="btns">
              <button mat-raised-button id="reset" (click)="resetForm()">Reset</button>
              <button mat-raised-button id="add" (click)="action==='add'?addReport() : editReport()">{{action==='add'?'Add Report' : 'Save Changes'}}</button>
            </div>
          
        </form>

    </div>


</div>